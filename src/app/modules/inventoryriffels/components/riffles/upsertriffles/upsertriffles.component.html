<h2 mat-dialog-title>

  <div class="d-flex justify-content-between align-items-center">
    <span class="fontsection">اضافة إذن مخزنى</span>
    <button class="col-md-1" mat-button [mat-dialog-close]="true" cdkFocusInitial>
      <mat-icon>close</mat-icon>
    </button>
  </div>

</h2>
<mat-divider></mat-divider>


<mat-dialog-content style="z-index: -1;" class="mat-typography" style="min-height: 78vh;overflow-y: auto;">

  <div class="row">
    <mat-card class="col-3 me-2 mat-elevation-z8">
      <form [formGroup]="masterForm">
        <div class="row">
  
          <div class="col-4">
            <mat-form-field appearance="outline">
              <mat-label> رقم الاذن </mat-label>
              <input matInput type="number" placeholder="" name="documentNumber" formControlName="documentNumber" [readonly]="isReadOnly"
                (keydown)="restrictZero($event)">
              <mat-hint>
                <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
        validation: 'required',
        message: 'AUTH.VALIDATION.REQUIRED' | translate : {name:'رقم المستند '},
        control: masterForm.controls['documentNumber']
      }"></ng-container>
  
                <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
        validation: 'pattern',
        message: 'AUTH.VALIDATION.INVALID' | translate : {name:'رقم المستند '},
        control:  masterForm.controls['documentNumber']
        }"></ng-container>
              </mat-hint>
            </mat-form-field>
          </div>
  
          <div class="col-12">
            <mat-form-field color="accent" appearance="outline">
              <mat-label>التاريخ الاذن</mat-label>
              <input matInput [matDatepicker]="picker2" [max]="maxDate" [readonly]="true" formControlName="documentDate" (dateChange)="onChangeDate();">
              <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
              <mat-datepicker #picker2 [disabled]="isReadOnly"></mat-datepicker>
  
              <mat-hint>
                <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
              validation: 'required',
              message: 'AUTH.VALIDATION.REQUIRED' | translate : {name:'التاريخ'},
              control: masterForm.controls['documentDate']}">
                </ng-container>
              </mat-hint>
            </mat-form-field>
          </div>
  
          <div class="col-12 pb-3">
            <ng-select #Stock [readonly]="isReadOnly" [items]="dropdownStock" bindLabel="Name" bindValue="Id" placeholder="أختر المخزن"
              formControlName="stock_Id" (change)=" onChangeDateOrStockOrTransType() ;onChangeDate();">
            </ng-select>
            <mat-hint>
              <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
          validation: 'required',
          message: 'AUTH.VALIDATION.REQUIRED' | translate : {name:'المخزن'},
          control: masterForm.controls['stock_Id']}">
              </ng-container>
            </mat-hint>
          </div>
  
          <div class="col-12">
            <ng-select #Stock [readonly]="isReadOnly" [items]="dropdownStock" bindLabel="Name" bindValue="Id" placeholder="أختر اللجنة"
              formControlName="committee_Id" (change)=" onChangeDateOrStockOrTransType() ;onChangeDate();">
            </ng-select>
            <mat-hint>
              <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
          validation: 'required',
          message: 'AUTH.VALIDATION.REQUIRED' | translate : {name:'اللجنة'},
          control: masterForm.controls['committee_Id']}">
              </ng-container>
            </mat-hint>
          </div>
  
          <div class="col-12">
            <mat-divider></mat-divider>
            <div class="row fixed-bottom mb-3 ms-8">
              <button mat-raised-button type="submit" (click)="saveButtonClickedFlag = true;" form="formmaster" [disabled]="loading" color="primary"
                style="width: 130px !important;">{{'HR.BUTTONS.SAVE'|translate}}</button>
              <button mat-raised-button color="warn" type="button"  class="mx-2" style="width: 150px !important;">
                {{'حذف جميع الاصناف'|translate}}</button>
              <button mat-button [mat-dialog-close]="true" cdkFocusInitial
                style="width: 100px !important;background-color: #e7e7e7;">{{'HR.BUTTONS.CLOSE'|translate}}</button>
            </div>
          </div>
        </div>
      </form>
  
    </mat-card>
  
    <div class="col">
  
      <div class="row">
  
        <mat-card class="col-12 p-0 mat-elevation-z8">
          <div class="row mx-5">
  
            <div class="col-3">
              <mat-form-field class="example-full-width" appearance="outline">
                <mat-label>بحث باسم المنتج </mat-label>
                <input type="text" matInput [matAutocomplete]="auto" [(ngModel)]="searchItem" #text (input)="inputAutoComplete(text.value)">
                <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayinputAutoComplete" (optionSelected)="onSelectedAutoComplete($event)">
                  <mat-option *ngFor="let option of autoCompleteItems" [value]="option">
                    {{option.Name}}
                  </mat-option>
                </mat-autocomplete>
                <mat-spinner matSuffix [diameter]="40" [hidden]="!itemLoader"></mat-spinner>
                <!-- <mat-icon matSuffix style="cursor: pointer;">search</mat-icon> -->
              </mat-form-field>
            </div>
  
          </div>
        </mat-card>
  
        <div class="col-12 px-0">
          <div class="example-container mat-elevation-z8 mt-5">
  
            <div class="example-table-container">
              <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
  
                <!-- Name Column -->
                <ng-container matColumnDef="n">
                  <th mat-header-cell *matHeaderCellDef> م</th>
                  <td mat-cell *matCellDef="let element; let x=index" style="cursor: pointer;">
                    <span>{{((page.PNum-1)*page.PSize)+(x+1) }}</span>
                  </td>
                </ng-container>
  
                <!-- Name Column {{"HR.INPUTS.NAME" | translate}}-->
                <ng-container matColumnDef="itemCode">
                  <th mat-header-cell *matHeaderCellDef> {{"TRANSACTIONS.TITLES.DOCNUMBER" | translate}} </th>
                  <td mat-cell *matCellDef="let element; let x=index">
                    <span>{{element.code}}</span>
                  </td>
                </ng-container>
  
                <!-- Name Column {{"HR.INPUTS.NAME" | translate}}-->
                <ng-container matColumnDef="itemName">
                  <th mat-header-cell *matHeaderCellDef> {{"TRANSACTIONS.TITLES.NAME" | translate}} </th>
                  <td mat-cell *matCellDef="let element; let x=index">
                    <span>{{element.name}}</span>
                  </td>
                </ng-container>
  
                <ng-container matColumnDef="quantity">
                  <th mat-header-cell *matHeaderCellDef> الكمية </th>
                  <td mat-cell *matCellDef="let element; let x=index" class="w-300px">
                    <table class="table m-0 my-1" style="border:2px solid rgb(187, 187, 187);">
                      <tr>
                        <th class="badge-success"> كرتونة</th>
                        <th class="badge-info"> علبة</th>
                        <th class=" "> قطعة</th>
                      </tr>
                      <tr style="border: 2px solid rgb(187, 187, 187);">
  
                        <td><input type="number" class="form-control p-1" [(ngModel)]="x.receivedQuantity" value="10" (keydown)="restrictZero($event)"></td>
                        <td><input type="number" class="form-control p-1" [(ngModel)]="x.receivedQuantity" value="10" (keydown)="restrictZero($event)"></td>
                        <td> <input type="number" class="form-control p-1" [(ngModel)]="x.receivedQuantity" value="10" (keydown)="restrictZero($event)"> </td>
                      </tr>
                    </table>
                    <span>{{element.price|number : '1.0-2'}}</span>
                  </td>
                </ng-container>
  
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns; let entry">
  
                </tr>
  
                <!-- Row shown when there is no matching data. -->
                <tr class="mat-row" *matNoDataRow>
                  <td class="mat-cell" colspan="4"> {{'SHARE.MESSAGE.NOROWFOUND'|translate}} </td>
                </tr>
              </table>
  
              <mat-paginator [pageSize]="page.PSize" (page)="pageEvent($event)" [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons
                aria-label="Select page of periodic elements">
              </mat-paginator>
            </div>
  
  
          </div>
        </div>
  
      </div>
  
    </div>
  </div>

</mat-dialog-content>


<!-- <mat-dialog-actions class="m-0 p-0">

  

</mat-dialog-actions> -->


<ng-template #formError let-control="control" let-message="message" let-validation="validation">
  <ng-container *ngIf="control.hasError(validation) && ( saveButtonClickedFlag || control.touched)">
    <div class="fv-plugins-message-container">
      <span role="alert">
        {{ message }}
      </span>
    </div>
  </ng-container>
</ng-template>